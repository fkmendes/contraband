<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood" required="BEAST v2.5.0" version="2.5">

  <run id="mcmc" spec="MCMC" chainLength="10000000">
    <state id="state" storeEvery="10000">
      <stateNode idref="OUSigmaSq"/>
      <stateNode idref="OURootValue"/>
      <stateNode idref="OUAlpha"/>
      <stateNode idref="OUTheta"/>
      <!-- <stateNode idref="OUThetaAssignments"/> -->
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

      <!-- START prior -->
      <distribution id="prior" spec="util.CompoundDistribution">
        <distribution id="SigmaSqPrior" spec="beast.math.distributions.Prior" x="@OUSigmaSq">
	  <distr id="Exp.OUSigmaSq" spec="beast.math.distributions.Exponential" offset="0.0" mean="[OUSigmaSqPriorMeanHere]"/>
        </distribution>

	<distribution id="RootValuePrior" spec="beast.math.distributions.Prior" x="@OURootValue">
	  <distr id="Normal.OURootValue" spec="beast.math.distributions.Normal" mean="[OURootValuePriorMeanHere]" sigma="[OURootValuePriorStdDevHere]"/>
        </distribution>

	<distribution id="AlphaPrior" spec="beast.math.distributions.Prior" x="@OUAlpha">
	  <distr id="LogNormal.OUAlpha" spec="beast.math.distributions.LogNormalDistributionModel" S="[OUAlphaPriorStdDevHere]" M="[OUAlphaPriorMeanHere]"/>
	</distribution>
	
	<distribution id="ThetaValuePrior" spec="beast.math.distributions.Prior" x="@OUTheta">
	  <distr id="Normal.OUTheta" spec="beast.math.distributions.Normal" mean="[OUThetaPriorMeanHere]" sigma="[OUThetaPriorStdDevHere]"/>
        </distribution>
      </distribution>
      <!-- END prior -->

      <distribution id="likelihood" spec="util.CompoundDistribution" useThreads="false">
	<distribution id="OUMVN" spec="contraband.OUMVNLikelihoodOneTrait" eqDist="false" useRootMetaData="true">	    
	  <tree id="FixedTree" spec="beast.util.TreeParser" IsLabelledNewick="true" adjustTipHeights="false" newick="[TreeHere]" offset="0" singlechild="false" binarizeMultifurcations="true">

	    <!-- <taxonset id="TaxonSet" spec="TaxonSet"> -->
	    <!--   <taxon id="sp1" spec="Taxon"/> -->
	    <!--   <taxon id="sp2" spec="Taxon"/> -->
	    <!--   <taxon id="sp3" spec="Taxon"/> -->
	    <!--   <taxon id="sp4" spec="Taxon"/> -->
	    <!-- </taxonset> -->
	  </tree>
  
	  <oneTraitData id="oneTraitData" spec="contraband.OneValueContTraits" nTraits="1" spNames="[SpNamesHere]">
	    <traitValues id="fixedTraitvalues" spec="parameter.RealParameter">[TraitValuesHere]</traitValues>
	  </oneTraitData>

	  <optimumManager id="optimumManager" spec="contraband.ColorManager" nTraits="1" nColors="3" coalCorrection="false">
	    <tree idref="FixedTree"/>
	    <colorValues id="OUTheta" spec="parameter.RealParameter">0.1 0.1 0.1</colorValues>
	    <colorAssignments id="OUThetaAssignments" spec="parameter.IntegerParameter">[ThetaAssignmentsHere]</colorAssignments>
	  </optimumManager>
	  
	  <sigmasq id="OUSigmaSq" dimension="1" spec="parameter.RealParameter">0.01</sigmasq>

	  <alpha id="OUAlpha" dimension="1" spec="parameter.RealParameter">0.01</alpha>
	      
	  <rootValue id="OURootValue" dimension="1" spec="parameter.RealParameter">0.0</rootValue>
	</distribution> <!-- END BMVN -->
      </distribution> <!-- END Likelihood -->
    </distribution> <!-- END Posterior -->

    <operator id="SigmaSqScaler" spec="ScaleOperator" parameter="@OUSigmaSq" scaleFactor="0.75" weight="3.0"/>
    <operator id="RootValueScaler" spec="RealRandomWalkOperator" parameter="@OURootValue" windowSize="10.0" weight="3.0"/>
    <operator id="AlphaSqScaler" spec="ScaleOperator" parameter="@OUAlpha" scaleFactor="0.75" weight="3.0"/>
    <operator id="ThetaValueScaler" spec="RealRandomWalkOperator" parameter="@OUTheta" windowSize="10.0" weight="3.0"/>
    <!-- <operator id="ThetaAssignmentWalker" spec="IntRandomWalkOperator" parameter="@OUThetaAssignments" windowSize="1" weight="10.0"/> -->
	
    <logger id="tracelog" fileName="[FileNameHere].log" logEvery="10000" model="@posterior" sanitiseHeaders="true" sort="smart">
      <log idref="posterior"/>
      <log idref="likelihood"/>
      <log idref="prior"/>
      <log idref="OUSigmaSq"/>
      <log idref="OURootValue"/>
      <log idref="OUAlpha"/>
      <log idref="OUTheta"/>
    </logger>

    <logger id="screenlog" logEvery="20000">
      <log idref="posterior"/>
      <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
      <log idref="likelihood"/>
      <log idref="prior"/>
    </logger>

    <logger id="treelog.t:firsthalf" fileName="[FileNameHere].trees" logEvery="10000000" mode="tree">
        <log id="TreeWithMetaDataLogger" spec="beast.evolution.tree.TreeWithMetaDataLogger" tree="@FixedTree"/>
    </logger>
  </run>
</beast>
