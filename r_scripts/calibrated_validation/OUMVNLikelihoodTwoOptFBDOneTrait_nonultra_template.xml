<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood:beast.evolution.speciation" required="BEAST v2.5.0" version="2.5">

  <data id="seqs" name="alignment">
    [SeqsHere]
  </data>
    
  <run id="mcmc" spec="MCMC" chainLength="60000000">
    <state id="state" storeEvery="60000">
      <tree idref="TheTree" name="stateNode"/>
      <parameter id="FBDbirthRate" name="stateNode">0.1</parameter>
      <parameter id="FBDdeathRate" name="stateNode">0.05</parameter>
      <parameter id="FBDsamplingRate" name="stateNode">0.01</parameter>
      <parameter id="FBDorigin" name="stateNode">[InitialOriginValue]</parameter>
      <stateNode idref="OUSigmaSq"/>
      <stateNode idref="OURootValue"/>
      <stateNode idref="OUAlpha"/>
      <stateNode idref="shiftIndicators"/>
      <stateNode idref="OUTheta"/>      
    </state>
	    
    <distribution id="posterior" spec="util.CompoundDistribution">

      <!-- START prior -->
      <distribution id="prior" spec="util.CompoundDistribution">
	<distribution id="FBD" spec="beast.evolution.speciation.SABirthDeathModel" conditionOnRhoSampling="true" birthRate="@FBDbirthRate" deathRate="@FBDdeathRate" samplingRate="@FBDsamplingRate" origin="@FBDorigin" tree="@TheTree"> 
          <parameter id="FBDremovalProb" lower="0.0" name="removalProbability" upper="1.0">0.0</parameter>                                                                                     
          <parameter id="FBDrho" estimate="false" lower="0.0" name="rho" upper="1.0">1.0</parameter>                                                                                 
        </distribution>                                                                                                                                                                        

        <distribution id="FBDbirthRatePrior" spec="beast.math.distributions.Prior" x="@FBDbirthRate">
	  <distr id="FBDbirthRateExponential" spec="beast.math.distributions.Exponential" offset="0.0" mean="[FBDbirthRatePriorMeanHere]"/>
        </distribution>                                                                                                                                                                               

	<distribution id="FBDdeathRatePrior" spec="beast.math.distributions.Prior" x="@FBDdeathRate">
	  <distr id="FBDdeathRateExponential" spec="beast.math.distributions.Exponential" offset="0.0" mean="[FBDdeathRatePriorMeanHere]"/>
        </distribution>                                                                                                                                                                               

	<distribution id="FBDsamplingRatePrior" spec="beast.math.distributions.Prior" x="@FBDsamplingRate">
	  <distr id="FBDsamplingRateExponential" spec="beast.math.distributions.Exponential" offset="0.0" mean="[FBDsamplingRatePriorMeanHere]"/>
        </distribution>                                                                                                                                                                               

	<distribution id="FBDoriginPrior" spec="beast.math.distributions.Prior" x="@FBDorigin">
	  <distr id="FBDoriginUniform" spec="beast.math.distributions.Uniform" upper="Infinity"/> 
        </distribution>
        
	<distribution id="SigmaSqPrior" spec="beast.math.distributions.Prior" x="@OUSigmaSq">
	  <distr id="LogNormal.OUSigmaSq" spec="beast.math.distributions.LogNormalDistributionModel" S="[OUSigmaSqPriorStdDevHere]" M="[OUSigmaSqPriorMeanHere]"/>
	</distribution>
	
	<distribution id="RootValuePrior" spec="beast.math.distributions.Prior" x="@OURootValue">
	  <distr id="Normal.OURootValue" spec="beast.math.distributions.Normal" mean="[OURootValuePriorMeanHere]" sigma="[OURootValuePriorStdDevHere]"/>
        </distribution>

	<distribution id="AlphaPrior" spec="beast.math.distributions.Prior" x="@OUAlpha">
	  <distr id="LogNormal.OUAlpha" spec="beast.math.distributions.LogNormalDistributionModel" S="[OUAlphaPriorStdDevHere]" M="[OUAlphaPriorMeanHere]"/>
	</distribution>
	
	<distribution id="ThetaValuePrior" spec="beast.math.distributions.Prior" x="@OUTheta">
	  <distr id="Normal.OUTheta" spec="beast.math.distributions.Normal" mean="[OUThetaPriorMeanHere]" sigma="[OUThetaPriorStdDevHere]"/>
        </distribution>
      </distribution>
      <!-- END prior -->

      <distribution id="likelihood" spec="util.CompoundDistribution" useThreads="false">
	<distribution id="GeneTree" spec="ThreadedTreeLikelihood" data="@seqs" tree="@TheTree">
          <siteModel id="JC69" spec="SiteModel">
            <parameter id="mutationRate" estimate="false" name="mutationRate">1.0</parameter>
            <parameter id="proportionInvariant" estimate="false" lower="0.0" name="proportionInvariant" upper="1.0">0.0</parameter>
            <substModel id="JukesCantor69" spec="JukesCantor"/>
	  </siteModel>
	  
          <branchRateModel id="StrictClock" spec="beast.evolution.branchratemodel.StrictClockModel">
            <parameter id="clockRate" estimate="false" name="clock.rate">[MutRateHere]</parameter>
          </branchRateModel>
        </distribution>

	<distribution id="OUMVN" spec="contraband.OUMVNLikelihoodOneTrait" eqDist="false" useRootMetaData="true">
	  <tree id="TheTree" spec="beast.util.TreeParser" IsLabelledNewick="true" adjustTipHeights="false" newick="[TreeHere]" offset="0" singlechild="false">
	    <trait id="FossilSet" spec="beast.evolution.tree.TraitSet" traitname="date-backward">
	      [FossilSetHere]
	      <taxa idref="TaxonSet"/>
	    </trait>
		  
	    <taxonset id="TaxonSet" spec="TaxonSet">
	      [TaxonSetHere]
	    </taxonset>
	  </tree>

	  <oneTraitData id="oneTraitData" spec="contraband.OneValueContTraits" nTraits="1" spNames="[SpNamesHere]">
	    <traitValues id="fixedTraitValues" spec="parameter.RealParameter">[TraitValuesHere]</traitValues>
	  </oneTraitData>

	  <optimumManager id="optimumManager" spec="contraband.ColorManagerTreeToVCVMat" coalCorrection="false">
	    <branchRateModel id="OUThetaRandomLocalClock" spec="beast.evolution.branchratemodel.RandomLocalClockModel" scaling="false" includeRoot="true">
	      <indicators id="shiftIndicators" spec="parameter.BooleanParameter" value="[ShiftIndicatorsHere]"/>
	      <rates id="OUTheta" spec="parameter.RealParameter" value="0.01"/>
	      <tree idref="TheTree"/>
	    </branchRateModel>
	    
	    <tree idref="TheTree"/>
	  </optimumManager>
	    
	  <sigmasq id="OUSigmaSq" dimension="1" spec="parameter.RealParameter">0.01</sigmasq>

	  <alpha id="OUAlpha" dimension="1" spec="parameter.RealParameter">1.0</alpha>
	      
	  <rootValue id="OURootValue" dimension="1" spec="parameter.RealParameter">0.0</rootValue>
	</distribution> <!-- END BMVN -->
      </distribution> <!-- END Likelihood -->
    </distribution> <!-- END Posterior -->

    <operator id="FBDoriginScaler" spec="ScaleOperator" parameter="@FBDorigin" scaleFactor="0.75" weight="3.0"/>
    <operator id="FBDbirthRateScaler" spec="ScaleOperator" parameter="@FBDbirthRate" scaleFactor="0.75" weight="10.0"/>
    <operator id="FBDdeathRateScaler" spec="ScaleOperator" parameter="@FBDdeathRate" scaleFactor="0.75" weight="10.0"/>
    <operator id="FBDsamplingRateScaler" spec="ScaleOperator" parameter="@FBDsamplingRate" scaleFactor="0.75" weight="10.0"/>
    <operator id="FBDLeafToSA" spec="LeafToSampledAncestorJump" tree="@TheTree" weight="10.0"/>
    <operator id="FBDSAWilsonBalding" spec="SAWilsonBalding" tree="@TheTree" weight="10.0"/>
    <operator id="FBDSAWide" spec="SAExchange" isNarrow="false" tree="@TheTree" weight="10.0"/>
    <operator id="FBDSANarrow" spec="SAExchange" tree="@TheTree" weight="10.0"/>
    <operator id="FBDSAUniformOperator" spec="SAUniform" tree="@TheTree" weight="20.0"/>
    <operator id="FBDSATreeRootScaler" spec="SAScaleOperator" rootOnly="true" scaleFactor="0.95" tree="@TheTree" weight="1.0"/>
    <operator id="FBDSATreeScaler" spec="SAScaleOperator" scaleFactor="0.95" tree="@TheTree" weight="3.0"/>

    <operator id="OUThetaValueWalker" spec="contraband.operators.RandomLocalTraitOperator" shiftIndicators="@shiftIndicators" traits="@OUTheta" windowSize="1.0" weight="50.0" p="0.5">
      <randomClockModel idref="OUThetaRandomLocalClock"/>
    </operator>

    <operator id="ShiftIndicatorMove" spec="contraband.operators.BitMoveOperator" weight="5.0" parameter="@shiftIndicators" k="1">
      <tree idref="TheTree"/>
    </operator>
	
    <operator id="SigmaSqScaler" spec="ScaleOperator" parameter="@OUSigmaSq" scaleFactor="0.75" weight="3.0"/>
    <operator id="RootValueScaler" spec="RealRandomWalkOperator" parameter="@OURootValue" windowSize="10.0" weight="3.0"/>
    <operator id="AlphaScaler" spec="ScaleOperator" parameter="@OUAlpha" scaleFactor="0.75" weight="3.0"/>
 	
    <logger id="tracelog" fileName="[FileNameHere].log" logEvery="60000" model="@posterior" sanitiseHeaders="true" sort="smart">
      <log idref="posterior"/>
      <log idref="likelihood"/>
      <log idref="prior"/>
      <log idref="shiftIndicators"/>
      <log idref="OUSigmaSq"/>
      <log idref="OURootValue"/>
      <log idref="OUAlpha"/>
      <log idref="OUTheta"/>
    </logger>

    <logger id="screenlog" logEvery="30000">
      <log idref="posterior"/>
      <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
      <log idref="likelihood"/>
      <log idref="prior"/>
    </logger>
	
    <logger id="treelog" fileName="[FileNameHere].trees" logEvery="60000" mode="tree">
      <log id="TreeWithMetaDataLogger" spec="contraband.RateAndShiftLogger" metadata="@shiftIndicators" branchratemodel="@OUThetaRandomLocalClock" tree="@TheTree"/>
    </logger>
  </run>
</beast>
