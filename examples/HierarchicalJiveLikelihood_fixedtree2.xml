<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood" required="BEAST v2.5.0" version="2.5">

  <run id="mcmc" spec="MCMC" chainLength="10000000">
    <state id="state" storeEvery="10000">
      <stateNode idref="HyperVarSigmaSq"/>
      <stateNode idref="HyperVarRootState"/>
      <stateNode idref="HyperMeanSigmaSq"/>
      <stateNode idref="HyperMeanRootState"/>
      <stateNode idref="JiveLogVars"/>
      <stateNode idref="JiveMeans"/>
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

      <!-- START prior -->
      <distribution id="prior" spec="util.CompoundDistribution">
        <distribution id="HyperMeanRootStatePrior" spec="beast.math.distributions.Prior" x="@HyperMeanRootState">
	  <distr id="Unif.HyperMeanRootState" spec="beast.math.distributions.Uniform" lower="-1E4" upper="1E4"/>
        </distribution>

        <distribution id="HyperVarRootStatePrior" spec="beast.math.distributions.Prior" x="@HyperVarRootState">
	  <distr id="Unif.HyperVarRootState" spec="beast.math.distributions.Uniform" lower="-10.0" upper="10.0"/>	  
        </distribution>

	<distribution id="HyperMeanSigmaSqPrior" spec="beast.math.distributions.Prior" x="@HyperMeanSigmaSq">
	  <distr id="Gamma.HyperMeanSigmaSq" spec="beast.math.distributions.Gamma" alpha="1.1" beta="5.0" mode="ShapeScale"/>
	</distribution>

	<distribution id="HyperVarSigmaSqPrior" spec="beast.math.distributions.Prior" x="@HyperVarSigmaSq">
	  <distr id="Gamma.HyperVarSigmaSq" spec="beast.math.distributions.Gamma" alpha="1.1" beta="5.0" mode="ShapeScale"/>
	</distribution>
	
	<distribution id="JiveMeansPrior" spec="contraband.BMMVNLikelihoodOneTrait">	    
	  <tree id="FixedTree" spec="beast.util.TreeParser" IsLabelledNewick="true" adjustTipHeights="false" newick="((sp1:1.0,sp2:1.0):2.0,sp3:3.0);" offset="0" singlechild="false">

	    <taxonset id="TaxonSet" spec="TaxonSet">
	      <taxon id="sp1" spec="Taxon"/>
	      <taxon id="sp2" spec="Taxon"/>
	      <taxon id="sp3" spec="Taxon"/>
	    </taxonset>
	  </tree>

	  <oneTraitData id="JiveMeansStash" spec="contraband.OneValueContTraits" spNames="sp1,sp2,sp3" nTraits="1">
	    <traitValues idref="JiveMeans"/>
	  </oneTraitData>

	  <sigmasq id="HyperMeanSigmaSq" dimension="1" spec="parameter.RealParameter">1.0</sigmasq>
	    
	  <mean id="HyperMeanRootState" dimension="1" spec="parameter.RealParameter">0.0</mean>
	</distribution>

	<distribution id="JiveLogVarsPrior" spec="contraband.BMMVNLikelihoodOneTrait">
	  <tree idref="FixedTree"/>
	  
	  <oneTraitData id="JiveLogVarsStash" spec="contraband.OneValueContTraits" spNames="sp1,sp2,sp3" nTraits="1">
	    <traitValues idref="JiveLogVars"/>
	  </oneTraitData>

	  <sigmasq id="HyperVarSigmaSq" dimension="1" spec="parameter.RealParameter">0.1</sigmasq>
	    
	  <mean id="HyperVarRootState" dimension="1" spec="parameter.RealParameter">0.5</mean>
	</distribution>
      </distribution>
      <!-- END prior -->

      <distribution id="likelihood" spec="util.CompoundDistribution" useThreads="false">
	<distribution id="JiveLikelihood" spec="contraband.JiveLikelihood">
	  <sampleData id="JiveSampleData" spec="contraband.ManyValuesOneContTrait" traitValues="sp1=-0.920944137376185,-1.13219640176781,-1.05676038210191&#124;sp2=1.25737512060296,0.611766814842927,1.19824627767705&#124;sp3=-0.398761912156282,0.398374018007448,-1.24820589814404"/>

	  <logSigmasqs id="JiveLogVars" dimension="3" spec="parameter.RealParameter">0.008367226 0.046144394 0.873075334</logSigmasqs>

	  <mus id="JiveMeans" dimension="3" spec="parameter.RealParameter">-1.00327528 0.89740582 -0.06752906</mus>
	</distribution> <!-- END Jive -->
	
      </distribution> <!-- END Likelihood -->
    </distribution> <!-- END Posterior -->

    <operator id="HyperVarSigmaSqScaler" spec="ScaleOperator" parameter="@HyperVarSigmaSq" scaleFactor="0.75" weight="3.0"/>
    <operator id="HyperMeanSigmaSqScaler" spec="ScaleOperator" parameter="@HyperMeanSigmaSq" scaleFactor="0.75" weight="3.0"/>
    <operator id="HyperVarRootStateRandomWalk" spec="RealRandomWalkOperator" parameter="@HyperVarRootState" windowSize="1.0" weight="3.0"/>
    <operator id="HyperMeanRootStateRandomWalk" spec="RealRandomWalkOperator" parameter="@HyperMeanRootState" windowSize="10.0" weight="3.0"/>
    <operator id="JiveLogVarsScaler" spec="RealRandomWalkOperator" parameter="@JiveLogVars" windowSize="1.0" weight="10.0"/>
    <operator id="JiveMeansRandomWalk" spec="RealRandomWalkOperator" parameter="@JiveMeans" windowSize="10.0" weight="10.0"/>
	
    <logger id="tracelog" fileName="Jive_fixedtree.log" logEvery="10000" model="@posterior" sanitiseHeaders="true" sort="smart">
      <log idref="posterior"/>
      <log idref="likelihood"/>
      <log idref="prior"/>
      <log idref="HyperVarSigmaSq"/>
      <log idref="HyperMeanSigmaSq"/>
      <log idref="HyperVarRootState"/>
      <log idref="HyperMeanRootState"/>
      <log idref="JiveLogVars"/>
      <log idref="JiveMeans"/>
    </logger>

    <logger id="screenlog" logEvery="1">
      <log idref="posterior"/>
      <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
      <log idref="likelihood"/>
      <log idref="prior"/>
    </logger>

    <logger id="treelog.t:firsthalf" fileName="Jive_fixedtree.trees" logEvery="10000000" mode="tree">
        <log id="TreeWithMetaDataLogger" spec="beast.evolution.tree.TreeWithMetaDataLogger" tree="@FixedTree"/>
    </logger>
  </run>
</beast>
