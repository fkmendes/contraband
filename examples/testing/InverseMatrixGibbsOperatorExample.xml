<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.branchratemodel:beast.evolution.likelihood" required="BEAST v2.5.0" version="2.5">


<!-- This is an example of likelihood calculation for continuous traits using Venlin's pruning algorithm -->
<!-- The traits are simulated on the initial tree -->
<!-- The trait correlations and root values are draw from the prior distributions to simulate data -->

<run id="mcmc" spec="MCMC" chainLength="10000000">
	<state id="state" storeEvery="5000">
        <parameter id="inverseMatrix" name="stateNode">1.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 1.0 0.0 0.0 0.0 0.0 1.0</parameter>
	</state>

    <distribution id="Prior" spec="beast.math.distributions.WishartDistribution" df="4.0" arg="@inverseMatrix">
        <scaleMatrix id="scaleMatrix" spec="parameter.RealParameter">
            1.0 -0.175283223475929 -0.552878461124008 -0.338763889588355
            -0.175283223475929 1.0 -0.277636021112134 -0.0484003472323715
            -0.552878461124008 -0.277636021112134 1.0 0.162728294974685
            -0.338763889588355 -0.0484003472323715 0.162728294974685 1.0
        </scaleMatrix>
    </distribution>

    <operator id="GibbsOperator" spec="contraband.prunelikelihood.InverseMatrixGibbsOperator" dimension="4" values="@inverseMatrix" distr="@Prior" weight="6.0"/>

    <logger id="tracelog" fileName="InverseMatrixGibbsOperatorExample.log" logEvery="2000" model="@Prior" sanitiseHeaders="true" sort="smart">
      <log idref="inverseMatrix"/>
    </logger>

    <logger id="screenlog" logEvery="10000">
        <log idref="Prior"/>
    </logger>
  </run>
</beast>
