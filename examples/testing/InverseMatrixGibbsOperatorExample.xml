<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.branchratemodel:beast.evolution.likelihood" required="BEAST v2.5.0" version="2.5">


<!-- This is an example of likelihood calculation for continuous traits using Venlin's pruning algorithm -->
<!-- The traits are simulated on the initial tree -->
<!-- The trait correlations and root values are draw from the prior distributions to simulate data -->

<run id="mcmc" spec="MCMC" chainLength="10000000">
	<state id="state" storeEvery="5000">
        <parameter id="inverseMatrix" name="stateNode">1.29097969784295 -1.25443361240318 -0.607220847667174 1.2243706854349 -1.25443361240318 5.13175707837791 2.85578386177197 0.128925820993445 -0.607220847667174 2.85578386177197 4.94282107792554 1.95836625382643 1.2243706854349 0.128925820993445 1.95836625382643 2.77157829292339</parameter>
	</state>

    <distribution id="Prior" spec="beast.math.distributions.WishartDistribution" df="4.0" arg="@inverseMatrix">
        <scaleMatrix id="scaleMatrix" spec="parameter.RealParameter">
            1.0 -0.185841124800541 -0.591749477761869 -0.0171776506005707
            -0.185841124800541 1.0 0.232402270797924 -0.320499523843824
            -0.591749477761869 0.232402270797924 1.0 0.354327997396208
            -0.0171776506005707 -0.320499523843824 0.354327997396208 1.0
        </scaleMatrix>
    </distribution>

    <operator id="GibbsOperator" spec="contraband.prunelikelihood.InverseMatrixGibbsOperator" dimension="4" values="@inverseMatrix" distr="@Prior" weight="6.0"/>

    <logger id="tracelog" fileName="InverseMatrixGibbsOperatorExample.log" logEvery="2000" model="@Prior" sanitiseHeaders="true" sort="smart">
      <log idref="inverseMatrix"/>
    </logger>

    <logger id="screenlog" logEvery="10000">
        <log idref="Prior"/>
    </logger>
  </run>
</beast>
