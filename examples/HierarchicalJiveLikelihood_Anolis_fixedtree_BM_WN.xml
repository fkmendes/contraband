<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood" required="BEAST v2.5.0" version="2.5">

  <run id="mcmc" spec="MCMC" chainLength="2000000" sampleFromPrior="true">
    <state id="state" storeEvery="10000">
	<stateNode idref="HyperMeanEvolRate"/>
	<stateNode idref="HyperMeanMean"/>
	<stateNode idref="HyperLogVarEvolRate"/>
	<stateNode idref="HyperLogVarMean"/>
	<stateNode idref="JiveLogVars"/>
	<stateNode idref="JiveMeans"/>
      </state>

      <!-- START posterior -->
      <distribution id="posterior" spec="util.CompoundDistribution">

	<!-- START prior -->
	<distribution id="prior" spec="util.CompoundDistribution">
        
        <!--  START hyper-prior -->
	<distribution id="HyperMeanEvolRatePrior" spec="beast.math.distributions.Prior" x="@HyperMeanEvolRate">
	  <distr id="Gamma.HyperMeanEvolRate" spec="beast.math.distributions.Gamma" alpha="1.1" beta="5.0" mode="ShapeScale"/>
	</distribution>
	
	<distribution id="HyperMeanMeanPrior" spec="beast.math.distributions.Prior" x="@HyperMeanMean">
	  <distr id="Unif.HyperMeanMean" spec="beast.math.distributions.Uniform" lower="0.0" upper="136.23"/>
	</distribution>

	<distribution id="HyperLogVarEvolRatePrior" spec="beast.math.distributions.Prior" x="@HyperLogVarEvolRate">
	  <distr id="Gamma.HyperLogVarEvolRate" spec="beast.math.distributions.Gamma" alpha="1.1" beta="5.0" mode="ShapeScale"/>
	</distribution>
	
	<distribution id="HyperLogVarMeanPrior" spec="beast.math.distributions.Prior" x="@HyperLogVarMean">
	  <distr id="Unif.HyperLogVarMean" spec="beast.math.distributions.Uniform" lower="0.0" upper="8.02"/>
	</distribution>
	<!-- END hyper-prior -->

	<!-- START BM/OU prior for means -->
	<distribution id="JiveMeansPrior" spec="contraband.BMMVNShiftLikelihoodOneTrait">
	  <tree id="FixedTree" spec="beast.util.TreeParser" IsLabelledNewick="true" adjustTipHeights="false" newick="(((((cybotes:11.04802957,(armouri:9.85746743,shrevei:9.85746743):1.190562144):3.31644494,whitemani:14.36447451):2.783755719,(strahmi:12.93828276,longitibialis:12.93828276):4.209947475):5.382653011,marcanoi:22.53088325):21.01029191,(((((quadriocellifer:9.000421692,sagrei:9.000421698):2.997543893,ophiolepis:11.99796559):3.870686412,mestrei:15.868652):1.66332339,(homolechis:6.276287129,jubar:6.276287127):11.25568826):7.19823243,(allogus:15.13139105,(ahli:8.273184746,rubribarbus:8.273184741):6.858206311):9.598816762):18.81096734);" offset="0" singlechild="false"/>
	
	  <oneTraitData id="JiveMeansStash" spec="contraband.OneValueContTraits" spNames="ahli,allogus,armouri,cybotes,homolechis,jubar,longitibialis,marcanoi,mestrei,ophiolepis,quadriocellifer,rubribarbus,sagrei,shrevei,strahmi,whitemani" nTraits="1">
	    <traitValues idref="JiveMeans"/>
	  </oneTraitData>
	
	  <rateManager id="MeansRateManager" spec="contraband.ColorManager" nTraits="1" nColors="1" coalCorrection="false">
	    <tree idref="FixedTree"/>
	
	    <colorValues id="HyperMeanEvolRate" spec="parameter.RealParameter">5.511849</colorValues>
	
	    <colorAssignments id="MeansAssignments" spec="parameter.IntegerParameter" lower="0" upper="0">0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</colorAssignments>
	  </rateManager>
	
	  <mean id="HyperMeanMean" dimension="1" spec="parameter.RealParameter">68.10971</mean>
	</distribution>
	<!-- END BM/OU prior for means -->

	<!-- START BM/OU prior for log-variances -->
	<distribution id="JiveLogVarsPrior" spec="contraband.WNLikelihood">
	  <oneTraitData id="JiveLogVarsStash" spec="contraband.OneValueContTraits" spNames="ahli,allogus,armouri,cybotes,homolechis,jubar,longitibialis,marcanoi,mestrei,ophiolepis,quadriocellifer,rubribarbus,sagrei,shrevei,strahmi,whitemani" nTraits="1">
	    <traitValues idref="JiveLogVars"/>
	  </oneTraitData>
	
	  <sigmaSqs id="HyperLogVarEvolRate" spec="parameter.RealParameter">5.511849</sigmaSqs>
	
	  <mus id="HyperLogVarMean" spec="parameter.RealParameter">4.01263</mus>
	
	  <normalAssignments id="LogVarsAssignments" spec="parameter.IntegerParameter" lower="0" upper="0">0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0</normalAssignments>
	</distribution>
	<!-- END BM/OU prior for log-variances -->
	  
	</distribution>
	<!-- END prior -->

	<!-- START Jive likelihood -->
	<distribution id="likelihood" spec="util.CompoundDistribution" useThreads="false">
	  <distribution id="JiveLikelihood" spec="contraband.JiveLikelihood">
	    <sampleData id="JiveSampleData" spec="contraband.ManyValuesOneContTrait" traitValues="ahli=59.13,56.575,51.26,49.785,48.82,48.735,45.86,44.095,44.055&#124;allogus=63.43,62.54,60.925,60.535,60.505,60.505,60.405,59.92,59.73,59.585,59.465,59.295,58.89,58.88,58.48,57.945,57.81,57.79,57.195,56.86,56.79,56.675,56.645,56.575,56.54,56.465,56.41,56.335,56.315,56.205,56.175,55.985,55.89,55.755,55.74,55.525,55.33,55.28,55.235,55.155,55.06,55,54.8,54.615,54.54,54.42,53.685,53.545,53.325,53.315,53.215,52.99,52.85,52.435,52.39,52.23,52.155,51.745,51.705,51.655,51.515,50.78,50.62,50.59,50.06,49.725,49.715,49.575,49.42,49.315,49.31,49.185,48.98,48.8,47.35,47.34,47.23,46.475,46.395,46.25,46.045,45.99,45.57,45.47,44.79,44.645,44.36,43.97,43.645,43.385,42.95,42.865,42.29,42.21,39.965,37.44&#124;armouri=65.495,63.43,63.335,63.165,62.23,62.225,61.97,61.845,61.44,60.3,59.255,58.06,57.56,57.23,56.94,56.845,56.46,55.18,54.98,54.465,54.375,54.05,53.19,52.585,52.5,50.015,49.86,47.885,45.85&#124;cybotes=73.495,73.365,72.335,71.87,71.32,71,70.555,70.21,70.15,69.59,69.305,69.225,69.19,69.1,68.77,68.075,67.665,67.645,67.425,67.37,67.32,67.29,67.25,67.215,67.18,67.085,67.03,67.015,66.83,66.81,66.57,66.56,66.515,66.46,66.395,66.35,66.27,66.27,66.255,66.215,66.205,66.125,66.025,65.975,65.85,65.77,65.57,65.545,65.525,65.37,65.37,65.275,65.245,65.245,65.135,65.03,65,64.92,64.895,64.615,64.435,64.375,64.365,64.305,64.245,64.2,64.18,64.055,63.925,63.88,63.835,63.785,63.745,63.73,63.645,63.575,63.505,63.48,63.415,63.215,63.205,63.17,63.155,63.04,63.01,62.88,62.82,62.815,62.805,62.71,62.71,62.675,62.655,62.605,62.58,62.565,62.56,62.555,62.515,62.46,62.455,62.435,62.37,62.245,62.23,62.185,62.12,62.105,62.085,62.06,62.045,61.97,61.97,61.96,61.945,61.91,61.895,61.865,61.715,61.64,61.635,61.575,61.535,61.425,61.4,61.37,61.355,61.31,61.305,61.225,61.21,61.19,61.15,61.11,61.06,61.05,61.015,60.87,60.865,60.76,60.64,60.5,60.495,60.455,60.435,60.365,60.365,60.32,60.315,60.305,60.24,60.13,60.12,59.92,59.885,59.79,59.745,59.62,59.395,59.37,59.365,59.29,59.275,59.25,59.03,59.025,59.025,59.02,59.01,59.01,58.93,58.875,58.79,58.785,58.71,58.635,58.62,58.605,58.565,58.44,58.42,58.295,58.29,58.235,58.135,58.13,58.125,58.075,58.04,57.88,57.79,57.665,57.62,57.585,57.415,57.405,57.39,57.37,57.19,57.18,57.115,56.975,56.94,56.775,56.585,56.565,56.56,56.47,56.455,56.34,56.325,56.23,55.95,55.86,55.66,55.64,55.475,55.47,55.23,55.165,55.15,54.885,54.63,54.565,54.515,54.37,54.16,54.03,53.94,53.83,53.8,53.62,53.585,52.755,52.735,52.445,52.225,52,51.96,51.695,51.665,51.655,51.57,51.43,51.415,51.365,51.315,51.01,50.9,50.865,50.81,50.62,50.41,50.345,50.155,50.065,50.01,49.915,49.625,49.415,49.2,49.13,49.085,48.745,48.425,48.4,48.335,48.255,48.205,48.16,47.9,47.685,47.565,47.505,47.48,47.21,47.19,47.035,47.03,46.995,46.93,46.92,46.435,46.41,46.265,46.22,46.21,46.125,44.79,44.69,43.655,43.585,43.525,43.215,42.775,42.665,42.62,42.59,41.09,39.75&#124;homolechis=66.16,62.855,61.95,60.79,60.4,60.365,59.56,59.545,58.98,58.125,58.06,57.765,57.51,57.47,57.165,57.095,57,56.6,56.58,56.49,56.385,56.27,56.11,56.085,56.035,55.92,55.85,55.825,55.765,55.69,55.68,55.535,55.515,55.41,55.105,55.03,54.865,54.795,54.755,54.705,54.64,54.415,54.37,54.3,54.285,54.22,54.07,54.035,53.975,53.925,53.845,53.79,53.76,53.755,53.68,53.565,53.53,53.475,53.42,53.22,53.2,53.11,53.11,53.105,53.085,53.01,52.975,52.945,52.895,52.855,52.805,52.795,52.705,52.665,52.595,52.59,52.57,52.53,52.525,52.395,52.37,52.32,52.22,52.19,52.185,51.935,51.905,51.795,51.74,51.725,51.58,51.575,51.53,51.495,51.495,51.455,51.355,51.345,51.28,51.245,51.2,51.19,51.125,51.115,51.055,51.005,50.905,50.82,50.82,50.69,50.62,50.465,50.445,50.435,50.425,50.415,50.33,50.25,50.195,50.19,50.135,50.135,50.13,50.11,50.09,50.08,50.045,50.005,49.995,49.98,49.975,49.92,49.87,49.845,49.835,49.82,49.79,49.7,49.63,49.625,49.615,49.6,49.59,49.57,49.565,49.55,49.54,49.53,49.47,49.465,49.435,49.43,49.4,49.38,49.295,49.195,49.18,49.175,49.16,49.105,49.085,49.04,48.905,48.835,48.815,48.81,48.62,48.61,48.605,48.555,48.535,48.525,48.51,48.505,48.455,48.4,48.395,48.395,48.395,48.37,48.35,48.33,48.27,48.245,48.21,48.205,48.175,48.14,48.135,48.065,48.02,48,47.995,47.99,47.99,47.915,47.875,47.84,47.835,47.78,47.74,47.51,47.51,47.495,47.46,47.435,47.41,47.41,47.275,47.22,47.205,47.11,47.085,47.06,46.96,46.89,46.89,46.86,46.65,46.47,46.46,46.255,46.23,46.18,46.165,46.115,46.045,46.035,45.96,45.95,45.81,45.79,45.735,45.705,45.66,45.61,45.6,45.525,45.44,45.16,45.075,44.655,44.2,44.17,44.005,43.805,43.61,43.55,43.355,43.32,43.035,42.945,42.475,42.455,42.395,42.275,42.145,42.11,42.025,41.675,41.025,40.945,40.59,40.59,39.27,38.76,37.83,36.935&#124;jubar=57.175,54.955,53.98,53.775,53.505,53.47,53.295,52.89,52.645,52.345,52.175,51.65,51.27,51.165,50.68,50.55,50.455,50.255,50.21,50.04,50.015,49.975,49.905,49.41,49.4,49.28,49.175,49.05,48.945,48.875,48.695,48.51,48.045,47.595,47.43,47.36,47.08,46.9,46.775,46.67,46.615,46.595,45.2,39.82,37.45&#124;longitibialis=72.67,71.63,71.62,71.505,71.16,71,70.88,70.71,70.225,70.1,69.915,69.77,69.755,69.635,69.1,68.19,68.055,67.78,67.49,67.48,66.755,65.505,63.32,59.74,59.255,57.73&#124;marcanoi=63.7,61.465,61.03,60.71,59.345,58.5,58.39,58.36,58.295,57.94,57.57,57.345,57.3,57.265,56.845,56.84,56.835,56.83,56.63,56.4,56.26,56.1,55.97,55.105,54.885,54.66,54.37,53.115,53.09,52.615,52.2,51.415,49.78,49.675,48.85,48.69,48.025,46.92,46.585,46.445&#124;mestrei=55.09,55.075,53.07,51.845,51.695,51.295,46.695,45.875,44.5,41.765,41.695,37.235,37.215&#124;ophiolepis=40.365,38.1,35.845,35.02,34.42,34.41,34.275,34.25,33.54,33.465,33.325,32.495,31.755&#124;quadriocellifer=49.895,47.54,44.465,42.785,40.47&#124;rubribarbus=60.565,60.56,59.15,58.99,58.25,57.88,57.4,56.12,54.63,54.505,53.76,53.515,51.515,49.285,47.15,46.195&#124;sagrei=61.635,60.425,60.275,60.205,60.185,58.06,57.85,57.8,57.705,57.52,57.485,57.24,57.02,56.99,56.895,56.71,56.62,56.56,56.38,56.135,56.01,55.73,55.66,55.585,55.565,55.42,55.335,55.27,55.235,55.235,55,54.82,54.685,54.625,54.575,54.495,54.38,54.365,54.26,54.24,54.15,53.74,53.565,53.5,53.49,53.29,53.285,53.265,53.2,53.15,53.125,53.05,53.035,52.975,52.89,52.845,52.685,52.645,52.52,52.485,52.38,52.22,52.195,52.15,51.975,51.97,51.94,51.935,51.665,51.64,51.62,51.585,51.565,51.54,51.395,51.38,51.27,51.23,51.2,51.195,51.15,51.13,51.125,51.065,50.94,50.92,50.915,50.875,50.82,50.75,50.69,50.69,50.66,50.64,50.62,50.55,50.535,50.535,50.53,50.505,50.485,50.46,50.44,50.415,50.36,50.33,50.15,50.135,50.08,49.995,49.95,49.945,49.85,49.615,49.61,49.55,49.49,49.465,49.35,49.31,49.24,49.21,49.21,49.13,49.12,49.08,49.05,49.05,49.03,49.03,48.975,48.72,48.715,48.71,48.675,48.63,48.55,48.48,48.43,48.355,48.16,48.1,48.095,48.075,47.965,47.9,47.855,47.83,47.645,47.355,47.23,47.13,47.04,46.9,46.86,46.735,46.64,46.605,46.49,46.385,46.305,46.265,46.2,46.16,46.12,46.065,45.915,45.87,45.87,45.845,45.81,45.69,45.525,45.46,45.43,45.42,45.355,45.29,45.08,45.02,44.97,44.955,44.78,44.775,44.76,44.49,44.41,44.27,43.785,43.63,43.5,43.335,43.16,43.13,43.11,42.73,42.21,42.175,41.7,41.505,41.13,41.115,40.99,40.765,40.755,39.55&#124;shrevei=56.865,55.045,54.28,54.14,53.7,53.28,53.27,51.63,51.475,51.035,50.64,48.5,48.33,47.57,47.13,46.91,46.175&#124;strahmi=77.88,75.265,72.11,70.725,69.73,68.285,68.25,68.245,66.585,61.955,61.89,61.38,58.585,56.64,56.46,50.765&#124;whitemani=65.64,60.165,55.895,53.915,53.91,53.66,51.165"/>

	    <sigmaSqs id="JiveLogVars" dimension="16" spec="parameter.RealParameter">3.30620036577985 3.45881851816873 3.25095446843698 3.88572664503317 3.00504684825733 2.51660761225943 2.76821395776225 2.92867192571009 3.7000620715312 1.67250160857097 2.64121874207952 3.0251645103431 2.9762988998513 2.35956602580739 4.01169727750198 3.19912928171356</sigmaSqs>
	    
	    <mus id="JiveMeans" dimension="16" spec="parameter.RealParameter">49.8127777777778 52.6209375 56.9903448275862 58.7746 50.134197761194 49.5834444444444 68.1144230769231 55.05875 47.1576923076923 34.7126923076923 45.031 54.966875 50.1287378640777 51.175 65.296875 56.3357142857143</mus>
	  </distribution>
	</distribution>
	<!-- END Jive likelihood -->
	
      </distribution>
      <!-- END Posterior -->

	<operator id="HyperMeanEvolRateScaler" spec="ScaleOperator" parameter="@HyperMeanEvolRate" scaleFactor="0.75" weight="3.0"/>
	<operator id="HyperMeanMeanScaler" spec="ScaleOperator" parameter="@HyperMeanMean" scaleFactor="0.75" weight="3.0"/>

	<operator id="HyperLogVarEvolRateScaler" spec="ScaleOperator" parameter="@HyperLogVarEvolRate" scaleFactor="0.75" weight="3.0"/>
	<operator id="HyperLogVarMeanRandomWalk" spec="RealRandomWalkOperator" parameter="@HyperLogVarMean" windowSize="0.1" weight="3.0"/>
      
      <operator id="JiveLogVarsScaler" spec="RealRandomWalkOperator" parameter="@JiveLogVars" windowSize="1.0" weight="10.0"/>
      <operator id="JiveMeansRandomWalk" spec="RealRandomWalkOperator" parameter="@JiveMeans" windowSize="10.0" weight="10.0"/>
      
      <logger id="tracelog" fileName="model2.log" logEvery="10000" model="@posterior" sanitiseHeaders="true" sort="smart">
	<log idref="posterior"/>
	<log idref="likelihood"/>
	<log idref="prior"/>
	<log idref="HyperMeanEvolRate"/>
	<log idref="HyperMeanMean"/>
	<log idref="HyperLogVarEvolRate"/>
	<log idref="HyperLogVarMean"/>
	<log idref="JiveLogVars"/>
	<log idref="JiveMeans"/>
      </logger>

      <logger id="screenlog" logEvery="20000">
	<log idref="posterior"/>
	<log id="ESS.0" spec="util.ESS" arg="@posterior"/>
	<log idref="likelihood"/>
	<log idref="prior"/>
      </logger>

      <logger id="treelog.t:firsthalf" fileName="model2.trees" logEvery="10000000" mode="tree">
        <log id="TreeWithMetaDataLogger" spec="beast.evolution.tree.TreeWithMetaDataLogger" tree="@FixedTree"/>
      </logger>
  </run>
</beast>
