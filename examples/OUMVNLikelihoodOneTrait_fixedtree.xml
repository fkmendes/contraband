<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<beast namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood" required="BEAST v2.5.0" version="2.5">

  <run id="mcmc" spec="MCMC" chainLength="5000000">
    <state id="state" storeEvery="5000">
      <stateNode idref="OUSigmaSq"/>
      <stateNode idref="OURootValue"/>
    </state>

    <distribution id="posterior" spec="util.CompoundDistribution">

      <!-- START prior -->
      <distribution id="prior" spec="util.CompoundDistribution">               
        <distribution id="SigmaSqPrior" spec="beast.math.distributions.Prior" x="@OUSigmaSq">
	  <distr id="Exp.OUSigmaSq" spec="beast.math.distributions.Exponential" offset="0.0" mean="0.2"/>
        </distribution>

        <distribution id="RootValuePrior" spec="beast.math.distributions.Prior" x="@OURootValue">
	      <distr id="Normal.Mean" spec="beast.math.distributions.Normal" mean="0.0" sigma="2.0"/>
        </distribution>
      </distribution>
      <!-- END prior -->

      <distribution id="likelihood" spec="util.CompoundDistribution" useThreads="false">
	    <distribution id="OUMVN" spec="contraband.OUMVNLikelihoodOneTrait">	    
	      <tree id="FixedTree" spec="beast.util.TreeParser" IsLabelledNewick="true" adjustTipHeights="false" newick="(((sp1[&Regime=1]:1.0, sp2[&Regime=1]:1.0)[&Regime=1]:1.0, sp3[&Regime=2]:2.0)[&Regime=0]:1.0, sp4[&Regime=0]:3.0)[&Regime=0];" offset="0" singlechild="false">

	        <taxonset id="TaxonSet" spec="TaxonSet">
	          <taxon id="sp1" spec="Taxon"/>
	          <taxon id="sp2" spec="Taxon"/>
	          <taxon id="sp3" spec="Taxon"/>
	          <taxon id="sp4" spec="Taxon"/>
	        </taxonset>
	      </tree>

	      <oneTraitData id="oneTraitData" spec="contraband.OneValueContTraits" traitValues="sp1=4.1,sp2= 4.5,sp3=5.9,sp4 =0.0 " nTraits="1"/>

	      <sigmasq id="OUSigmaSq" dimension="1" spec="parameter.RealParameter">1.248328</sigmasq>

	      <alpha id="OUalpha" dimension="1" spec="parameter.RealParameter">31.20814</alpha>
	      
	      <rootValue id="OURootValue" dimension="1" spec="parameter.RealParameter">2.228585e-40</rootValue>
	    </distribution> <!-- END BMVN -->
	    
      </distribution> <!-- END Likelihood -->
    </distribution> <!-- END Posterior -->

    <operator id="SigmaSqScaler" spec="ScaleOperator" parameter="@OUSigmaSq" scaleFactor="0.75" weight="3.0"/>
    <operator id="MeanScaler" spec="RealRandomWalkOperator" parameter="@OURootValue" windowSize="10.0" weight="3.0"/>
	
    <logger id="tracelog" fileName="OUMVN_fixedtree.log" logEvery="5000" model="@posterior" sanitiseHeaders="true" sort="smart">
	  <log idref="posterior"/>
      <log idref="likelihood"/>
      <log idref="prior"/>
	  <log idref="OUSigmaSq"/>
      <log idref="OURootValue"/>
    </logger>

    <logger id="screenlog" logEvery="1">
        <log idref="posterior"/>
        <log id="ESS.0" spec="util.ESS" arg="@posterior"/>
        <log idref="likelihood"/>
        <log idref="prior"/>
    </logger>

    <logger id="treelog.t:firsthalf" fileName="OUMVN_fixedtree.trees" logEvery="5000000" mode="tree">
        <log id="TreeWithMetaDataLogger" spec="beast.evolution.tree.TreeWithMetaDataLogger" tree="@FixedTree"/>
    </logger>
  </run>
</beast>
